---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";
import WorkshopGridIsland from "../components/islands/WorkshopGridIsland.jsx";
import { getContent } from "../content";
import { getLanguageFromUrl, defaultLanguage } from "../content/i18n";
import {
  getWorkshopsForLanguage,
  prepareWorkshopData,
} from "../content/workshopHelpers";

// Get language from URL
const currentLang = getLanguageFromUrl(Astro.url.pathname);
const content = getContent(currentLang);
const { workshops: workshopsPageContent } = content.pages;

// Get workshops for the current language
const workshops = await getWorkshopsForLanguage(currentLang);

// Transform workshops data for the island component
const workshopsData = prepareWorkshopData(workshops, currentLang);

const heroContent = workshopsPageContent.hero;
---

<Layout
  title={`Workshops - CoderDojo SchÃ¶neweide`}
  description={content.site.description}
>
  <Hero hero={heroContent} />

  <!-- Workshop Grid Section -->
  <section
    class="py-20 bg-white dark:bg-gray-900 text-accent-900 dark:text-gray-100"
    dir={currentLang === "ar" ? "rtl" : "ltr"}
  >
    <div class="container mx-auto px-6">
      <WorkshopGridIsland
        workshops={workshopsData}
        labels={workshopsPageContent.labels}
        client:load
      />
    </div>
  </section>
</Layout>
