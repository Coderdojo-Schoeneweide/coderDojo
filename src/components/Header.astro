---
import { Picture } from 'astro:assets';
import { icon } from '@fortawesome/fontawesome-svg-core';
import { faTicket, faLanguage } from '@fortawesome/free-solid-svg-icons';
import { useTranslations } from '@/i18n.ts';
import logo from '@/assets/images/logo.png';
import LanguageSelector from '@/components/LanguageSelector.astro';

const t = useTranslations(Astro.currentLocale);

const menuItems = [
  { name: t('menu.items.workshops'), url: '/workshops' },
  { name: t('menu.items.mentoring'), url: '/mentoring' },
  { name: t('menu.items.society'), url: '/verein' },
  { name: t('menu.items.collaborations'), url: '/kooperationen' },
];
---

<header class="text-dark bg-brand text-lg font-semibold">
  <div class="container mx-auto px-6">
    <div class="flex h-16 items-center justify-between">
      <a href="/" class="flex">
        <Picture
          src={logo}
          formats={['avif', 'webp']}
          alt="logo"
          layout="constrained"
          priority={true}
          width={100}
          class="h-16 w-auto"
        />
      </a>

      <nav class="hidden items-center space-x-8 md:flex">
        {menuItems.map((item) => <a href={item.url}>{item.name}</a>)}
        <a
          href="https://pretix.eu/dojosw"
          class="h-lh w-8"
          aria-label="Buy ticket"
        >
          <Fragment set:html={icon(faTicket).html} />
        </a>
        <button class="plain relative">
          <Fragment set:html={icon(faLanguage).html} />
          <LanguageSelector />
        </button>
      </nav>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-toggle"
        class="rounded-lg bg-gray-100 p-2 text-gray-600 md:hidden dark:bg-gray-800 dark:text-gray-300"
        aria-label="Toggle mobile menu"
      >
        <svg
          class="h-6 w-6 fill-none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"
          >
          </path>
        </svg>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div
      id="mobile-menu"
      class="hidden border-t border-gray-200 py-4 md:hidden dark:border-gray-700"
    >
      {
        menuItems.map((item) => (
          <a
            href={item.url}
            class="hover:text-primary-600 dark:hover:text-primary-400 block py-2 font-medium text-gray-600 dark:text-gray-300"
          >
            {item.name}
          </a>
        ))
      }
    </div>
  </div>
</header>

<script>
  // Theme toggle functionality
  const themeToggle = document.getElementById('theme-toggle');
  const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');

  themeToggle?.addEventListener('click', () => {
    const isDark = document.documentElement.classList.toggle('dark');
    // Save theme preference to localStorage
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  });

  mobileMenuToggle?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });
</script>
